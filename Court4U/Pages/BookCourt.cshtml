@page "{ClubId}"
@model Court4U.Pages.BookCourtModel
@{
    Layout = "_UserLayout";
}

<div class="container mx-auto mt-20">

    @if (!string.IsNullOrEmpty(TempData["BookingMessage"] as string))
    {
        <div class="alert alert-info">@TempData["BookingMessage"]</div>
    }

    <div class="p-5 bg-gray-100 rounded-lg shadow-md">
        <form method="post" asp-page-handler="SearchSlot">
            <div class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 items-center">
                <div class="flex-1">
                    <label for="selectedDate" class="font-semibold">Select Date:</label>
                    <input asp-for="SearchDate" type="date" class="bg-white text-black border border-gray-300 rounded-lg py-2 px-4 w-full" />
                </div>
                <div class="flex-1">
                    <button type="submit" class="bg-blue-500 text-white py-2 px-4 rounded-lg mt-4 md:mt-0 w-full md:w-auto">Load Slots</button>
                </div>
            </div>
        </form>
    </div>

    @if (Model.Slots != null && Model.Slots.Any())
    {
        <h3 class="text-xl font-semibold mt-8">Available Slots:</h3>
        <form method="post">
            <div class="overflow-x-auto mt-4">
                <table class="table-auto border-collapse border border-gray-300 w-full">
                    <thead>
                        <tr class="bg-gray-200">
                            <th class="border border-gray-300 px-4 py-2">Select</th>
                            <th class="border border-gray-300 px-4 py-2">Date</th>
                            <th class="border border-gray-300 px-4 py-2">Start Time</th>
                            <th class="border border-gray-300 px-4 py-2">End Time</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var slot in Model.Slots)
                        {
                            <tr class="hover:bg-gray-100">
                                <td class="border border-gray-300 px-4 py-2">
                                    <input type="radio" name="SelectedSlotId" value="@slot.Id" required/>
                                </td>
                                <td class="border border-gray-300 px-4 py-2">@slot.DateOfWeek.ToString("dd/MM/yyyy")</td>
                                <td class="border border-gray-300 px-4 py-2">@slot.StartTime.ToShortTimeString()</td>
                                <td class="border border-gray-300 px-4 py-2">@slot.EndTime.ToShortTimeString()</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <div class="flex justify-end mt-4">
                <button type="submit" formaction="/BookCourt/ClubId?handler=OnPostAsync" class="bg-green-500 text-white py-2 px-4 rounded-lg">Book Selected Slot</button>
            </div>
        </form>
    }
    else if (Model.Slots == null)
    {
        <p class="mt-8">Please select a date to view available slots.</p>
    }
    else
    {
        <p class="mt-8">No slots available for the selected date.</p>
    }
</div>